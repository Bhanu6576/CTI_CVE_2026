{
  "id": "CVE-2025-66438",
  "title": "Security Advisory: CVE-2025-66438",
  "severity": "CRITICAL",
  "cvssScore": 9.8,
  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "publishedDate": "2025-12-15T18:15:48.410",
  "description": "A Server-Side Template Injection (SSTI) vulnerability exists in the Frappe ERPNext through 15.89.0 Print Format rendering mechanism. Specifically, the API frappe.www.printview.get_html_and_style() triggers the rendering of the html field inside a Print Format document using frappe.render_template(template, doc) via the get_rendered_template() call chain. Although ERPNext wraps Jinja2 in a SandboxedEnvironment, it exposes sensitive functions such as frappe.db.sql through get_safe_globals(). An authenticated attacker with permission to create or modify a Print Format can inject arbitrary Jinja expressions into the html field. Once the malicious Print Format is saved, the attacker can call get_html_and_style() with a target document (e.g., Supplier or Sales Invoice) to trigger the render process. This leads to information disclosure from the database, such as database version, schema details, or sensitive values, depending on the injected payload. Exploitation flow: Create a Print Format with SSTI payload in the html field; call the get_html_and_style() API; triggers frappe.render_template(template, doc) inside get_rendered_template(); leaks database information via frappe.db.sql or other exposed globals.",
  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66438",
  "references": [
    "https://iamanc.github.io/post/erpnext-ssti-bug-5",
    "https://www.notion.so/SSTI-bug-5-239e6086eadc80a48f17c1257a604d2c?source=copy_link"
  ],
  "summary": "CVE-2025-66438 is a CRITICAL severity vulnerability with a CVSS score of 9.8. A Server-Side Template Injection (SSTI) vulnerability exists in the Frappe ERPNext through 15.89.0 Print Format rendering mechanism. Specifically, the API frappe.www.printview.get_html_and_style() tri...",
  "impact": "CRITICAL: This vulnerability poses an immediate and severe risk to affected systems. Exploitation could lead to complete system compromise, data breach, or service disruption.",
  "remediation": "1. Review the CVE details and assess the impact on your systems\n2. Check if any of your systems or applications are affected\n3. Apply vendor-provided patches or updates as soon as possible\n4. If patches are not available, implement compensating controls\n5. Monitor systems for signs of exploitation\n6. Review and update security policies as needed",
  "timestamp": "2025-12-16T18:16:14.297Z"
}